//defaultTasks 'explodedWar'
project.version = '1.0'

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'eclipse'

// ================ Provided ========================
// Scope "provided" is not supported by Gradle by default, so let's declare it.

// From http://stackoverflow.com/questions/20421681
// See also http://forums.gradle.org/gradle/topics/how_do_i_best_define_dependencies_as_provided
configurations {
    provided

    // This makes `gradle idea` to generate duplicates of all `compile` deps as `provided` as well.
    // provided.extendsFrom(compile)
}
sourceSets {
    // For command-line gradle to recognize 'provided' scope.
    main {
        compileClasspath += configurations.provided
    }
}
idea {
    module {
        scopes.PROVIDED.plus += configurations.provided
        downloadJavadoc = false
        downloadSources = true
    }
}
eclipse {
    classpath {
        downloadSources = true
    }
}
// ================ / Provided ======================

sourceCompatibility = 1.7

repositories {
    mavenCentral()
}

dependencies {
    compile 'com.google.code.findbugs:jsr305:2.+'
    compile 'com.google.guava:guava:+'
    compile 'joda-time:joda-time:+'
    compile 'commons-io:commons-io:+'
    compile 'org.apache.commons:commons-lang3:+'

    // GAE
    compile 'com.google.appengine:appengine-api-1.0-sdk:+'
    compile ('com.googlecode.objectify:objectify:+') {
        exclude module: 'com.google.appengine:appengine-api-labs'
    }

    // Web stack
    provided 'javax.servlet:servlet-api:2.5' // GAE has its own embedded servlet-api.
    compile 'com.sun.jersey:jersey-server:1.+'
    compile 'com.sun.jersey:jersey-servlet:1.+'
    compile 'com.sun.jersey:jersey-core:1.+'
    compile 'com.sun.jersey.contribs:jersey-guice:1.+'
    compile 'com.fasterxml.jackson.core:jackson-annotations:+'
    compile 'com.fasterxml.jackson.jaxrs:jackson-jaxrs-json-provider:+' // Handle application/json
    compile 'com.fasterxml.jackson.datatype:jackson-datatype-joda:+'

    // OAuth
    //compile 'com.google.oauth-client:google-oauth-client:+'
    compile 'net.oauth.core:oauth:20100527'

    //provided 'org.eclipse.jetty:jetty-server:+'
    //provided 'org.eclipse.jetty:jetty-servlet:+'


    // Logging
    compile 'org.slf4j:slf4j-api:+'
    compile 'org.slf4j:slf4j-jdk14:+'

    // DI
    compile 'javax.inject:javax.inject:1'
    compile 'com.google.inject:guice:+'
    compile 'com.google.inject.extensions:guice-servlet:+'
    compile 'com.google.inject.extensions:guice-multibindings:3.0'

    // Test
    testCompile 'org.testng:testng:+'
    testCompile 'org.mockito:mockito-all:+'

    testCompile 'com.google.appengine:appengine-api-stubs:+'
    testCompile 'com.google.appengine:appengine-testing:+'
}

